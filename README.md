# VulnerabilityClassifier

<!-- PROJECT LOGO -->
<br />
<p align="center">
  <a href="https://github.com/Yuni0217/VulnerabilityClassifier">
  </a>
  <br />

  <!-- Badges -->
  <img src="https://img.shields.io/github/repo-size/Yuni0217/VulnerabilityClassifier?style=for-the-badge" alt="GitHub repo size" height="25">
  <img src="https://img.shields.io/github/last-commit/Yuni0217/VulnerabilityClassifier?style=for-the-badge" alt="GitHub last commit" height="25">
  <img src="https://img.shields.io/github/license/Yuni0217/VulnerabilityClassifier?style=for-the-badge" alt="License" height="25">
  <br />
  
  <h3 align="center">VulnerabilityClassifier</h3>
  <p align="center">
    Automated Vulnerability Scoring and Categorisation Toolset for Vulnerability Reports.
 
  </p>
</p>


<!-- TABLE OF CONTENTS -->
## Table of Contents

* [About the Tool](#about-the-tool)
* [Severity Prediction Under CVSS Version 3](#severity-prediction-under-cvss-v3)
   *  [Tutorial](#tutorial)
   *  [Local Usage](#local-installation)
* [Severity Prediction Under CVSS Version 2](#severity-prediction-under-cvss-v2)
   *  [Tutorial](#tutorial)
* [Threat Prediction Using CVEDetails](#threat-prediction-using-cvedetails)
   *  [Tutorial](#tutorial)
* [Future Works](#future-works)
* [References](#references)


## About the Tool
Vulnerability severity scoring and categorisation using machine-learning tools. VulnerabilityClassifier is an open-source toolkit that employs machine-learning techniques to learn vulnerability labels assigned by [NVD](https://nvd.nist.gov/vuln/full-listing), vendors, [cvedetails](https://www.cvedetails.com/), and other repositories, in order to predict the labels for new vulnerability reports. Here, "labels" refers to [CVSS](https://www.first.org/cvss/specification-document)-metric labels, threat types provided by [cvedetails](https://www.cvedetails.com/vulnerabilities-by-types.php), weakness types provided by [CWE](https://cwe.mitre.org/index.html), and attack types provided by [CAPEC](https://capec.mitre.org/index.html). The purpose is to support a higher level of automation in vulnerability assessment.

The recommended environment is Python 3. The tutorials need Jupyter Notebook (by Anaconda Navigator).

## Severity Prediction Under CVSS V3

The purpose here is to be able to automatically assign a severity score to any vulnerability instance with a descriptive report, using the CVSS Version 3 standard. Two examples are shown below, whereby the TestingSamples have labels initially set as (CVSS score = 0) and other values as "l", and the labels of the PredictedSamples are predicted by the trained machine-learning models.

<p align="center">
<img src="https://github.com/Yuni0217/VulnerabilityClassifier/blob/main/CVSSV3prediction/src/CVSSV3_prediction_example.png" alt="System" width="750px">
</p>

### Tutorial 
A severity computation pipeline that streamlines the process of machine-learning model training, testing, and validation is illustrated in the [CVSS V3 Notebook](https://github.com/Yuni0217/VulnerabilityClassifier/blob/main/CVSSV3prediction/predictionForCVSSVersion3UseLR.ipynb), in a step-by-step manner. 
- Machine-learning model: [Logistic Regression](https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LogisticRegression.html) algorithm is utilised to show the applicability of the proposed approach. Any other machine-learning model can be applied to further improve the model performances.
- Training/Testing dataset: [NVD](https://nvd.nist.gov/vuln/full-listing) data feeds (2002-2020).
- Validating dataset: [NVD](https://nvd.nist.gov/vuln/full-listing) data feeds (2021).

### Local Usage 
- Step 1: Clone the repo using the following command:
```bash
git clone https://github.com/Yuni0217/VulnerabilityClassifier.git 
```
- Step 2: Create a virtual environment.

- Step 3: Install requirements using `pip`:
```bash
pip install -r requirements.txt
```
- Step 4: Download datasets from NVD feeds.
```bash
python ./CVSSV3prediction/updateDB.py
```
- Step 5: Train machine-learning models for different CVSS V3 mechanisms and store them.
```bash
python ./CVSSV3prediction/trainScoreCVSSV3.py
```
- Step 6: Using the trained machine-learning models to predict CVSS V3 scores for any vulnerability document.
```bash
python ./CVSSV3prediction/predictScoreCVSSV3.py -p './CVSSV3prediction/testData' -s -v
```

## Severity Prediction Under CVSS V2

Similarly, vulnerability severity score under CVSS Version 2 can be predicted using trained machine-learning model.

<p align="center">
<img src="https://github.com/Yuni0217/VulnerabilityClassifier/blob/main/CVSSV2prediction/src/CVSSV2example.png" alt="System" width="750px">
</p>

### Tutorial 
The model training, testing, validation process is illustrated in the [CVSS V2 Notebook](https://github.com/Yuni0217/VulnerabilityClassifier/blob/main/CVSSV2prediction/predictionForCVSSVersion2UseLR.ipynb), in a step-by-step manner.
- Machine-learning model: [Logistic Regression](https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LogisticRegression.html).
- Training/Testing dataset: [NVD](https://nvd.nist.gov/vuln/full-listing) data feeds (2002-2020).
- Validating dataset: [NVD](https://nvd.nist.gov/vuln/full-listing) data feeds (2021).

## Threat Prediction Using CVEDetails

Threat categories that one vulnerability might be exposed to can be predicted using trained machine-learning model.

### Tutorial
The model training, testing, validation process is illustrated in the [Threat Prediction Notebook](https://github.com/Yuni0217/VulnerabilityClassifier/blob/main/threatPrediction/threatCategorisationWithLSTMRNN.ipynb)
- Machine-learning model: [LSTM](https://www.tensorflow.org/api_docs/python/tf/keras/layers/LSTM) Model.
- Training/Testing dataset: [NVD](https://nvd.nist.gov/vuln/full-listing) data feeds (2002-2021); [cvedetails](https://www.cvedetails.com/).

## Future Works
- More classification works related to weakness types provided by [CWE](https://cwe.mitre.org/index.html), attack types provided by [CAPEC](https://capec.mitre.org/index.html) would be added. 
- More visualisation tools.
- Wrapping up prediction models for different purposes (threat categorisation, CVSS-metric categorisation, CWE classification) into a pipeline.

## References
-[A selective ensemble model for cognitive cybersecurity analysis](https://www.sciencedirect.com/science/article/pii/S1084804521002125)
